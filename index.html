<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raspberry Pi Sense HAT Explorer - CICF</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .icon {
            font-size: 1.3em;
        }

        /* LED Matrix */
        .led-matrix {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 4px;
            margin: 20px auto;
            max-width: 320px;
            background: #222;
            padding: 10px;
            border-radius: 10px;
        }

        .led-pixel {
            aspect-ratio: 1;
            background: #1a1a1a;
            border-radius: 3px;
            transition: all 0.1s;
            cursor: pointer;
        }

        .led-pixel.lit {
            box-shadow: 0 0 10px currentColor;
        }

        .led-pixel.drawing-mode:hover {
            opacity: 0.7;
            transform: scale(1.1);
        }

        /* Mode Toggle */
        .mode-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            justify-content: center;
        }

        .mode-btn {
            background: #e2e8f0;
            color: #4a5568;
            border: 2px solid #cbd5e0;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .mode-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .mode-btn:hover:not(.active) {
            background: #cbd5e0;
        }

        /* Controls */
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
        }

        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button.generate-btn {
            background: #48bb78;
            flex: 1;
        }

        button.generate-btn:hover {
            background: #38a169;
        }

        /* Sensor Display */
        .sensor-data {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .sensor-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .sensor-item .value {
            font-size: 2em;
            font-weight: bold;
            margin: 10px 0;
        }

        .sensor-item .label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        /* Code Tabs */
        .code-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: -1px;
            flex-wrap: wrap;
        }

        .code-tab {
            background: #4a5568;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s;
            opacity: 0.7;
        }

        .code-tab:hover {
            opacity: 0.9;
        }

        .code-tab.active {
            background: #2d3748;
            opacity: 1;
            transform: translateY(0);
        }

        /* Code Block */
        .code-container {
            margin-top: 15px;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #2d3748;
            color: white;
            padding: 10px 15px;
            border-radius: 8px 8px 0 0;
        }

        .code-header span {
            font-size: 0.9em;
            font-weight: bold;
        }

        .copy-btn {
            background: #48bb78;
            padding: 5px 15px;
            font-size: 0.85em;
        }

        .copy-btn:hover {
            background: #38a169;
        }

        pre {
            margin: 0;
            background: #1a202c;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            font-size: 0.9em;
            line-height: 1.5;
            max-height: 400px;
        }

        code {
            font-family: 'Courier New', monospace;
        }

        .code-example {
            display: none;
        }

        .code-example.active {
            display: block;
        }

        /* Joystick */
        .joystick-demo {
            display: grid;
            grid-template-columns: repeat(3, 60px);
            grid-template-rows: repeat(3, 60px);
            gap: 5px;
            margin: 20px auto;
            justify-content: center;
        }

        .joy-btn {
            background: #667eea;
            border: 2px solid #5568d3;
            border-radius: 10px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .joy-btn:hover {
            background: #5568d3;
            transform: scale(1.05);
        }

        .joy-btn:active {
            transform: scale(0.95);
            background: #4c51bf;
        }

        .joy-btn.center {
            background: #e53e3e;
            border-color: #c53030;
            grid-column: 2;
            grid-row: 2;
        }

        .joy-btn.center:hover {
            background: #c53030;
        }

        /* Orientation Demo */
        .orientation-visual {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            position: relative;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            transition: transform 0.3s;
        }

        .orientation-dot {
            width: 20px;
            height: 20px;
            background: #48bb78;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 20px #48bb78;
        }

        .slider-control {
            margin: 15px 0;
        }

        .slider-control label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        input[type="range"] {
            width: 100%;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }

            header h1 {
                font-size: 1.8em;
            }

            .sensor-data {
                grid-template-columns: 1fr 1fr;
            }
        }

        .info-box {
            background: #edf2f7;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .info-box strong {
            color: #667eea;
        }

        .info-box.drawing-mode {
            background: #f0fff4;
            border-left-color: #48bb78;
        }

        .info-box.drawing-mode strong {
            color: #48bb78;
        }

        footer {
            text-align: center;
            color: white;
            margin-top: 30px;
            padding: 20px;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéÆ Raspberry Pi Sense HAT Explorer</h1>
            <p>Interactive guide for CICF - Learn by exploring!</p>
        </header>

        <div class="main-grid">
            <!-- LED Matrix Card -->
            <div class="card">
                <h2><span class="icon">üí°</span> LED Matrix (8x8)</h2>
                
                <div class="mode-toggle">
                    <button class="mode-btn active" onclick="setMode('demo')">üé¨ Demo Mode</button>
                    <button class="mode-btn" onclick="setMode('draw')">‚úèÔ∏è Draw Mode</button>
                </div>

                <div id="demoInfo" class="info-box">
                    <strong>Try it:</strong> Click the buttons to see different LED patterns!
                </div>
                <div id="drawInfo" class="info-box drawing-mode" style="display: none;">
                    <strong>Draw Mode:</strong> Click on pixels to draw (white only). Then click "Generate Code" to get your Python code!
                </div>

                <div class="led-matrix" id="ledMatrix"></div>
                
                <div id="demoControls" class="controls">
                    <button onclick="testAllRows()">Test All Rows</button>
                    <button onclick="showRainbow()">Rainbow</button>
                    <button onclick="showHeart()">Heart</button>
                    <button onclick="clearMatrix()">Clear</button>
                </div>

                <div id="drawControls" class="controls" style="display: none;">
                    <button onclick="clearMatrix()">Clear Canvas</button>
                    <button class="generate-btn" onclick="generateCode()">üêç Generate Code</button>
                </div>

                <div class="code-container">
                    <div class="code-tabs">
                        <button class="code-tab active" onclick="switchTab('basic')">Basic</button>
                        <button class="code-tab" onclick="switchTab('heart')">Heart</button>
                        <button class="code-tab" onclick="switchTab('rainbow')">Rainbow</button>
                        <button class="code-tab" onclick="switchTab('custom')">Your Design</button>
                    </div>
                    <div class="code-header">
                        <span>üêç Python Code</span>
                        <button class="copy-btn" onclick="copyActiveCode()">Copy</button>
                    </div>
                    
                    <!-- Basic Code -->
                    <div class="code-example active" id="code-basic">
                        <pre><code>from sense_hat import SenseHat
import time

sense = SenseHat()

# Light up a single pixel (red)
sense.set_pixel(3, 3, 255, 0, 0)
time.sleep(1)

# Show a message
sense.show_message("Hello CICF!", scroll_speed=0.05)

# Clear the display
sense.clear()</code></pre>
                    </div>

                    <!-- Heart Code -->
                    <div class="code-example" id="code-heart">
                        <pre><code>from sense_hat import SenseHat

sense = SenseHat()

# Define heart pattern (0 = off, 1 = on)
heart = [
    0,1,1,0,0,1,1,0,
    1,1,1,1,1,1,1,1,
    1,1,1,1,1,1,1,1,
    1,1,1,1,1,1,1,1,
    0,1,1,1,1,1,1,0,
    0,0,1,1,1,1,0,0,
    0,0,0,1,1,0,0,0,
    0,0,0,0,0,0,0,0
]

# Draw the heart (pink color)
for i in range(64):
    if heart[i] == 1:
        x = i % 8
        y = i // 8
        sense.set_pixel(x, y, 255, 0, 100)</code></pre>
                    </div>

                    <!-- Rainbow Code -->
                    <div class="code-example" id="code-rainbow">
                        <pre><code>from sense_hat import SenseHat
import time

sense = SenseHat()

# Rainbow colors (one per row)
colors = [
    [255, 0, 0],      # Red
    [255, 127, 0],    # Orange
    [255, 255, 0],    # Yellow
    [0, 255, 0],      # Green
    [0, 0, 255],      # Blue
    [75, 0, 130],     # Indigo
    [148, 0, 211],    # Violet
    [255, 255, 255]   # White
]

# Draw rainbow row by row
for y in range(8):
    for x in range(8):
        r, g, b = colors[y]
        sense.set_pixel(x, y, r, g, b)
    time.sleep(0.2)  # Animate the drawing</code></pre>
                    </div>

                    <!-- Custom Code (Generated) -->
                    <div class="code-example" id="code-custom">
                        <pre><code id="customCodeContent">from sense_hat import SenseHat

sense = SenseHat()

# Draw your custom design here
# Click "Draw Mode" and draw on the matrix
# Then click "Generate Code" to see your code here!

sense.clear()</code></pre>
                    </div>
                </div>
            </div>

            <!-- Temperature & Environment Card -->
            <div class="card">
                <h2><span class="icon">üå°Ô∏è</span> Environmental Sensors</h2>
                <div class="info-box">
                    <strong>Note:</strong> Temperature readings are affected by Raspberry Pi heat. Add 3-5¬∞C to get real room temperature!
                </div>
                <div class="sensor-data">
                    <div class="sensor-item">
                        <div class="label">Temperature</div>
                        <div class="value" id="temp">--¬∞C</div>
                    </div>
                    <div class="sensor-item">
                        <div class="label">Humidity</div>
                        <div class="value" id="humidity">--%</div>
                    </div>
                    <div class="sensor-item">
                        <div class="label">Pressure</div>
                        <div class="value" id="pressure">-- mb</div>
                    </div>
                </div>
                <button onclick="simulateSensors()">Simulate Readings</button>

                <div class="code-container">
                    <div class="code-header">
                        <span>üêç Python Code</span>
                        <button class="copy-btn" onclick="copyCode('code-env')">Copy</button>
                    </div>
                    <pre><code id="code-env">from sense_hat import SenseHat

sense = SenseHat()

# Read temperature
temp = sense.get_temperature()
print(f"Temperature: {temp:.1f}¬∞C")

# Read humidity
humidity = sense.get_humidity()
print(f"Humidity: {humidity:.1f}%")

# Read pressure
pressure = sense.get_pressure()
print(f"Pressure: {pressure:.1f} mbar")</code></pre>
                </div>
            </div>

            <!-- Motion & Orientation Card -->
            <div class="card">
                <h2><span class="icon">üéØ</span> Motion & Orientation</h2>
                <div class="info-box">
                    <strong>Try it:</strong> Move the sliders to see how the Sense HAT detects tilt and rotation!
                </div>
                <div class="orientation-visual" id="orientationBox">
                    <div class="orientation-dot" id="orientationDot"></div>
                </div>
                
                <div class="slider-control">
                    <label>Pitch (forward/back tilt): <span id="pitchValue">0</span>¬∞</label>
                    <input type="range" min="-90" max="90" value="0" id="pitchSlider">
                </div>
                <div class="slider-control">
                    <label>Roll (left/right tilt): <span id="rollValue">0</span>¬∞</label>
                    <input type="range" min="-90" max="90" value="0" id="rollSlider">
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <span>üêç Python Code</span>
                        <button class="copy-btn" onclick="copyCode('code-motion')">Copy</button>
                    </div>
                    <pre><code id="code-motion">from sense_hat import SenseHat

sense = SenseHat()

# Get orientation (pitch, roll, yaw)
orientation = sense.get_orientation_degrees()
print(f"Pitch: {orientation['pitch']:.1f}¬∞")
print(f"Roll: {orientation['roll']:.1f}¬∞")
print(f"Yaw: {orientation['yaw']:.1f}¬∞")

# Get raw accelerometer data
accel = sense.get_accelerometer_raw()
print(f"x: {accel['x']:.2f}g")
print(f"y: {accel['y']:.2f}g")
print(f"z: {accel['z']:.2f}g")</code></pre>
                </div>
            </div>

            <!-- Joystick Card -->
            <div class="card">
                <h2><span class="icon">üïπÔ∏è</span> 5-Direction Joystick</h2>
                <div class="info-box">
                    <strong>Try it:</strong> Click the arrows and center button to see how the joystick works!
                </div>
                <div class="joystick-demo">
                    <div></div>
                    <div class="joy-btn" onclick="joystickPress('UP')">‚Üë</div>
                    <div></div>
                    <div class="joy-btn" onclick="joystickPress('LEFT')">‚Üê</div>
                    <div class="joy-btn center" onclick="joystickPress('PRESS')">‚óè</div>
                    <div class="joy-btn" onclick="joystickPress('RIGHT')">‚Üí</div>
                    <div></div>
                    <div class="joy-btn" onclick="joystickPress('DOWN')">‚Üì</div>
                    <div></div>
                </div>
                <div id="joystickOutput" style="text-align: center; font-size: 1.2em; color: #667eea; font-weight: bold; min-height: 30px;"></div>

                <div class="code-container">
                    <div class="code-header">
                        <span>üêç Python Code</span>
                        <button class="copy-btn" onclick="copyCode('code-joy')">Copy</button>
                    </div>
                    <pre><code id="code-joy">from sense_hat import SenseHat
from signal import pause

sense = SenseHat()

# Handle joystick up
def pushed_up(event):
    if event.action == 'pressed':
        sense.show_letter("U", text_colour=[0, 255, 0])

# Handle joystick down
def pushed_down(event):
    if event.action == 'pressed':
        sense.show_letter("D", text_colour=[0, 255, 0])

# Handle joystick middle (press)
def pushed_middle(event):
    if event.action == 'pressed':
        sense.show_letter("M", text_colour=[255, 0, 0])

# Assign functions to joystick directions
sense.stick.direction_up = pushed_up
sense.stick.direction_down = pushed_down
sense.stick.direction_middle = pushed_middle

pause()  # Keep running</code></pre>
                </div>
            </div>

            <!-- Complete Test Card -->
            <div class="card" style="grid-column: 1 / -1;">
                <h2><span class="icon">üöÄ</span> Complete Sense HAT Test</h2>
                <div class="info-box">
                    <strong>All-in-One:</strong> Copy this code to test everything at once on your Raspberry Pi!
                </div>

                <div class="code-container">
                    <div class="code-header">
                        <span>üêç Complete Test Script</span>
                        <button class="copy-btn" onclick="copyCode('code-complete')">Copy</button>
                    </div>
                    <pre><code id="code-complete">from sense_hat import SenseHat
import time

sense = SenseHat()

print("=" * 50)
print("  SENSE HAT COMPLETE TEST - CICF")
print("=" * 50)

# 1. LED Test
print("\n1. Testing LED Matrix...")
for y in range(8):
    sense.clear()
    for x in range(8):
        sense.set_pixel(x, y, 255, 0, 0)
    print(f"   Row {y} lit")
    time.sleep(0.3)

sense.show_message("OK!", scroll_speed=0.05, text_colour=[0, 255, 0])
sense.clear()

# 2. Environmental Sensors
print("\n2. Testing Environmental Sensors...")
temp = sense.get_temperature()
humidity = sense.get_humidity()
pressure = sense.get_pressure()

print(f"   Temperature: {temp:.1f}¬∞C")
print(f"   Humidity: {humidity:.1f}%")
print(f"   Pressure: {pressure:.1f} mbar")

# 3. Motion Sensors
print("\n3. Testing Motion Sensors...")
orientation = sense.get_orientation_degrees()
accel = sense.get_accelerometer_raw()

print(f"   Pitch: {orientation['pitch']:.1f}¬∞")
print(f"   Roll: {orientation['roll']:.1f}¬∞")
print(f"   Yaw: {orientation['yaw']:.1f}¬∞")
print(f"   Acceleration: x={accel['x']:.2f}g y={accel['y']:.2f}g z={accel['z']:.2f}g")

# 4. Compass
print("\n4. Testing Compass...")
north = sense.get_compass()
print(f"   North direction: {north:.1f}¬∞")

# 5. Joystick
print("\n5. Testing Joystick...")
print("   Press any direction on the joystick!")
print("   (Test will wait 5 seconds)")

event_detected = False
def any_direction(event):
    global event_detected
    if event.action == 'pressed':
        event_detected = True
        print(f"   ‚úì {event.direction} detected!")
        sense.show_letter("‚úì", text_colour=[0, 255, 0])

sense.stick.direction_any = any_direction
time.sleep(5)

if not event_detected:
    print("   ‚ö† No joystick input detected")

sense.clear()
print("\n" + "=" * 50)
print("  TEST COMPLETE!")
print("=" * 50)</code></pre>
                </div>
            </div>
        </div>

        <footer>
            <p><strong>Centro de Inova√ß√£o Carlos Fiolhais</strong></p>
            <p>Made for teaching Raspberry Pi Sense HAT to young innovators üöÄ</p>
            <p style="margin-top: 10px; font-size: 0.9em;">This is a simulator - run the Python code on your actual Raspberry Pi with Sense HAT!</p>
        </footer>
    </div>

    <script>
        // Create LED Matrix
        const ledMatrix = document.getElementById('ledMatrix');
        const pixels = [];
        let currentMode = 'demo';
        let pixelStates = Array(64).fill(0); // Track pixel states for drawing mode

        for (let i = 0; i < 64; i++) {
            const pixel = document.createElement('div');
            pixel.className = 'led-pixel';
            pixel.dataset.index = i;
            pixel.addEventListener('click', handlePixelClick);
            ledMatrix.appendChild(pixel);
            pixels.push(pixel);
        }

        function handlePixelClick(e) {
            if (currentMode !== 'draw') return;
            
            const index = parseInt(e.target.dataset.index);
            pixelStates[index] = pixelStates[index] === 1 ? 0 : 1;
            
            if (pixelStates[index] === 1) {
                e.target.style.backgroundColor = 'rgb(255, 255, 255)';
                e.target.classList.add('lit');
            } else {
                e.target.style.backgroundColor = '#1a1a1a';
                e.target.classList.remove('lit');
            }
        }

        function setMode(mode) {
            currentMode = mode;
            
            // Update mode buttons
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update pixels
            pixels.forEach(pixel => {
                if (mode === 'draw') {
                    pixel.classList.add('drawing-mode');
                } else {
                    pixel.classList.remove('drawing-mode');
                }
            });
            
            // Update UI
            if (mode === 'demo') {
                document.getElementById('demoInfo').style.display = 'block';
                document.getElementById('drawInfo').style.display = 'none';
                document.getElementById('demoControls').style.display = 'flex';
                document.getElementById('drawControls').style.display = 'none';
                clearMatrix();
            } else {
                document.getElementById('demoInfo').style.display = 'none';
                document.getElementById('drawInfo').style.display = 'block';
                document.getElementById('demoControls').style.display = 'none';
                document.getElementById('drawControls').style.display = 'flex';
                clearMatrix();
                switchTab('custom');
            }
        }

        function setPixel(x, y, r, g, b) {
            const index = y * 8 + x;
            if (pixels[index]) {
                pixels[index].style.backgroundColor = `rgb(${r}, ${g}, ${b})`;
                pixels[index].classList.add('lit');
            }
        }

        function clearMatrix() {
            pixels.forEach(pixel => {
                pixel.style.backgroundColor = '#1a1a1a';
                pixel.classList.remove('lit');
            });
            pixelStates.fill(0);
        }

        function testAllRows() {
            if (currentMode !== 'demo') return;
            clearMatrix();
            let row = 0;
            const interval = setInterval(() => {
                if (row > 0) {
                    for (let x = 0; x < 8; x++) {
                        setPixel(x, row - 1, 0, 0, 0);
                    }
                }
                if (row < 8) {
                    for (let x = 0; x < 8; x++) {
                        setPixel(x, row, 255, 0, 0);
                    }
                    row++;
                } else {
                    clearInterval(interval);
                    setTimeout(clearMatrix, 500);
                }
            }, 400);
        }

        function showRainbow() {
            if (currentMode !== 'demo') return;
            clearMatrix();
            switchTab('rainbow');
            const colors = [
                [255, 0, 0],
                [255, 127, 0],
                [255, 255, 0],
                [0, 255, 0],
                [0, 0, 255],
                [75, 0, 130],
                [148, 0, 211],
                [255, 255, 255]
            ];
            
            colors.forEach((color, y) => {
                setTimeout(() => {
                    for (let x = 0; x < 8; x++) {
                        setPixel(x, y, color[0], color[1], color[2]);
                    }
                }, y * 150);
            });
        }

        function showHeart() {
            if (currentMode !== 'demo') return;
            clearMatrix();
            switchTab('heart');
            const heart = [
                0,1,1,0,0,1,1,0,
                1,1,1,1,1,1,1,1,
                1,1,1,1,1,1,1,1,
                1,1,1,1,1,1,1,1,
                0,1,1,1,1,1,1,0,
                0,0,1,1,1,1,0,0,
                0,0,0,1,1,0,0,0,
                0,0,0,0,0,0,0,0
            ];
            
            heart.forEach((val, i) => {
                if (val === 1) {
                    const x = i % 8;
                    const y = Math.floor(i / 8);
                    setPixel(x, y, 255, 0, 100);
                }
            });
        }

        function generateCode() {
            const litPixels = [];
            pixelStates.forEach((state, i) => {
                if (state === 1) {
                    const x = i % 8;
                    const y = Math.floor(i / 8);
                    litPixels.push({x, y});
                }
            });

            let code = `from sense_hat import SenseHat

sense = SenseHat()

# Your custom design
`;
            
            if (litPixels.length === 0) {
                code += `# No pixels lit yet!
# Draw on the matrix and click "Generate Code" again

sense.clear()`;
            } else if (litPixels.length <= 10) {
                // Simple approach for few pixels
                code += `# Light up individual pixels (white)
`;
                litPixels.forEach(p => {
                    code += `sense.set_pixel(${p.x}, ${p.y}, 255, 255, 255)\n`;
                });
            } else {
                // Array approach for many pixels
                code += `# Define your pattern (0 = off, 1 = on)
pattern = [
`;
                for (let row = 0; row < 8; row++) {
                    code += '    ';
                    for (let col = 0; col < 8; col++) {
                        const index = row * 8 + col;
                        code += pixelStates[index] + ',';
                    }
                    code += '\n';
                }
                code += `]

# Draw the pattern (white color)
for i in range(64):
    if pattern[i] == 1:
        x = i % 8
        y = i // 8
        sense.set_pixel(x, y, 255, 255, 255)`;
            }

            document.getElementById('customCodeContent').textContent = code;
            switchTab('custom');
        }

        // Code Tab Switching
        function switchTab(tabName) {
            // Update tabs
            document.querySelectorAll('.code-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target?.classList.add('active');
            
            // Update code examples
            document.querySelectorAll('.code-example').forEach(example => {
                example.classList.remove('active');
            });
            document.getElementById(`code-${tabName}`).classList.add('active');
        }

        function copyActiveCode() {
            const activeExample = document.querySelector('.code-example.active code');
            const code = activeExample.textContent;
            navigator.clipboard.writeText(code).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚úì Copied!';
                btn.style.background = '#38a169';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '#48bb78';
                }, 2000);
            });
        }

        // Simulate Sensors
        function simulateSensors() {
            const temp = (18 + Math.random() * 8).toFixed(1);
            const humidity = (40 + Math.random() * 30).toFixed(1);
            const pressure = (980 + Math.random() * 40).toFixed(1);
            
            document.getElementById('temp').textContent = temp + '¬∞C';
            document.getElementById('humidity').textContent = humidity + '%';
            document.getElementById('pressure').textContent = pressure + ' mb';
        }

        // Orientation
        const pitchSlider = document.getElementById('pitchSlider');
        const rollSlider = document.getElementById('rollSlider');
        const pitchValue = document.getElementById('pitchValue');
        const rollValue = document.getElementById('rollValue');
        const orientationBox = document.getElementById('orientationBox');
        const orientationDot = document.getElementById('orientationDot');

        pitchSlider.addEventListener('input', updateOrientation);
        rollSlider.addEventListener('input', updateOrientation);

        function updateOrientation() {
            const pitch = pitchSlider.value;
            const roll = rollSlider.value;
            
            pitchValue.textContent = pitch;
            rollValue.textContent = roll;
            
            orientationBox.style.transform = `rotateX(${pitch}deg) rotateY(${roll}deg)`;
            
            const dotX = 50 + (roll * 0.3);
            const dotY = 50 + (pitch * 0.3);
            orientationDot.style.left = dotX + '%';
            orientationDot.style.top = dotY + '%';
        }

        // Joystick
        function joystickPress(direction) {
            const output = document.getElementById('joystickOutput');
            output.textContent = `${direction} pressed!`;
            output.style.color = direction === 'PRESS' ? '#e53e3e' : '#667eea';
            
            setTimeout(() => {
                output.textContent = '';
            }, 1500);
        }

        // Copy Code (for non-tabbed sections)
        function copyCode(elementId) {
            const code = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(code).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚úì Copied!';
                btn.style.background = '#38a169';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '#48bb78';
                }, 2000);
            });
        }

        // Initialize
        simulateSensors();
    </script>
</body>
</html>
